[
["index.html", "Phylogenetic Biology Preface", " Phylogenetic Biology Casey W. Dunn 2020-08-16 Preface I developed this book as a collection of the concepts, methods, and applications that I most wanted to share with students in my Phylogenetic Biology courses. "],
["intro.html", "Chapter 1 Introduction 1.1 Why phylogenies matter 1.2 Required background 1.3 Additional resources", " Chapter 1 Introduction Phylogenetic biology is the study of evolutionary relationships. There are three components to a phylogenetic analysis: characters, evolutionary models, and phylogenetic trees. In any given study we could have data, not care, or want to infer any three of these. When we don’t care, we marginalize. When we have data we fix. When we want to infer we estimate. This gives a broad range of hypothetical phylogenetic investigations. Only a subset of these are common in the literature, due to the questions that drive the field right now, the available data, and the methods that have been implemented in software tools. When we want to infer phylogenetic trees, we usually fix the characters at the tips using our data, marginalize over historical character states, estimate models, and estimate the tree. When we want to infer the history of character evolution, we often fix the tree, fix the characters at the tips using our data, estimate the model, and estimate the character history. But we can also marginalize over models, for example. 1.1 Why phylogenies matter History of life on earth Phylogenetic systematics Comparative methods Processes of evolution Current and future evolution (eg epidemiology) 1.2 Required background Comfort at the command line, manipulation of text files. Practical Computing for Biologists. Basic literacy with the programming language R. R for Data Science. Basic statistics, in particular probability theory. Some math, in particular an understanding of matrices and manipulations of matrices. 1.3 Additional resources "],
["trees.html", "Chapter 2 Trees 2.1 Phylogenies are graphs 2.2 Drawing phylogenies 2.3 Rotating nodes 2.4 The meaning of edge lengths 2.5 Rooting 2.6 Polytomies 2.7 The information contained in phylogenies 2.8 Representation 2.9 Final thoughts 2.10 Additional reading", " Chapter 2 Trees Figure 2.1: Darwin’s depiction of the evolutioanry relationships between organisms (Darwin 1859). Phylogenies are representations of evolutionary relationships. The only figure in Darwin’s Origin of Species was a phylogeny (Figure 2.1), though he didn’t call it that. Phylogenies are often referred to as trees. It is an apt analogy. From the anchoring of the tree at a root, to the depiction of lineages as branches, to the reference of tips as leaves, there is a direct correspondence. Many of the first speculative phylogenies were illustrated as actual trees (Figure 2.2). Figure 2.2: Haeckel’s hypothesis of the animal phylogeny (Haeckel 1897), drawn as an actual tree. He also coined the term phylogeny. Not all trees in science, or even biology, are phylogenies, though. For example, hierarchical clustering results in trees that represent similarity, rather than shared evolutionary history. In some cases phylogeny and clustering of organisms will be largely congruent, but in many cases they will not be. Hierarchical tree-like clustering is also used for things that have no evolutionary component, like similarity of responses to a drug. It is helpful, then, to be more precise about the components of a phylogeny, and what each of those parts represent. 2.1 Phylogenies are graphs As we refine the precision of what a phylogeny is, it is helpful to think of it in a rigorous mathematical framework rather than a botanical analogy. Figure 2.3: A simple graph. Nodes are represented by circles, and edges by lines. Note that this graph has a cycle (you could walk in a circle between nodes 1, 2, and 4). It is also not bifurcating, as nodes have from one to four edges connected to them. A phylogeny is a specific instance of a mathematical object known as a (graph)[https://en.wikipedia.org/wiki/Graph_(discrete_mathematics)]. A graph consists of nodes (also called vertices in a mathematical context), often represented as circles, connected by edges, often represented by lines or curves (Figure 2.3). Graphs are useful representations of a variety of systems. For example, nodes could be people, and edges family relationships, connections in a social network, or financial transactions. Figure 2.4: A graph representing a phylogeny. The tip nodes typically represent sampled entities, like living organisms, sequenced genes, or fossils. The internal nodes are ancestors that immediately precede branching events. The root is a special internal node that has no parent. It is acyclic (ie, there are no paths that go in circles). The graph is bifurcating– the root node has two edges that connect it to its children, the other internal nodes each have three edges (one that connects to the parent, two to children), and the tips each have one edge (that connects to their parents). Because there is so much to learn from adjacent fields when using mathematical conventions, I will tend to use mathematical notation for phylogenies rather than the classical botanical nomenclatures. I will refer to edges rather than branches, terminal nodes rather than leaves, etc… Phylogeny graphs (Figure 2.4) usually have a few specific topological properties: They are acyclic. This means that there is only one path from one node to another, and that it isn’t possible to go in circles. Exceptions can arise in cases of horizontal gene transfer or hybridization. They tend to be bifurcating. This means that each internal node has one parent node and two daughter nodes, and therefore three edges connected to it. This represents the biological understanding of speciation, which usually proceeds by one lineage giving rise to two lineages. Some phylogenies are not strictly bifurcating, in which they are said to have a polytomy. This can be either due to uncertainty about branching order (a soft polytomy) or multiple divergence events in very quick succession, giving rise at effectively the same time to more than two lineages. They can be directed. This means that edges are not symmetric, and instead have directionality. Specifically, they denote time. The node on one end of the edge is older than the node on the other side of the edge. A phylogenetic graph is an abstraction, and for it to be useful it is important to keep in mind what it actually is. The nodes are entities that can evolve, like organisms or genes. The edges indicate evolutionary relationships between those entities. You could imagine as, an extreme case, a graph that showed every single individual that ever existed in your group of interest, say mammals. Each edge would connect each individual to its immediate ancestors. That would be a big phylogeny, and you would never have enough information to know it all, but it does exist even if unknowable and unwieldy given our current tools. A phylogeny is a subset of that graph, where we often retain a single individual per species as the tip nodes, and retain nodes immediately preceding divergence events as the internal nodes. In this respect, a phylogeny is a subgraph of the entire history of life on Earth. In a fully bifurcating tree with \\(n\\) tip nodes, there are \\(n-1\\) internal nodes. For example, Figure 2.4 shows a tree with 4 tip nodes (labeled 1-4) and 3 internal nodes (labeled 4-7). 2.2 Drawing phylogenies You will rarely see a phylogeny depicted as in Figure 2.4, with a circle for every node. It gets too cluttered. Instead, it is simpler to draw just the edges (Figure 2.5), with the nodes implied at the ends of edges (including at their intersections, which are internal nodes). The nodes are implied. Figure 2.5: A phylogeny of some mammals, downloaded from http://vertlife.org . Note that node circles are not drawn, instead nodes are implied at ends of edges. There is considerable variation in how the exact same phylogeny can be drawn (Figure 2.6). This gives some flexibility in deciding what presentation is best for your particular goals, but can also create confusion because two images that look very different may in fact be of the exact same phylogeny. Rectangular layouts are the most common, because the entire branch length is along one axis of the plot. Slanted layouts avoid the elbows of rectangular layouts, but because the edges aren’t parallel and can be at a variety of angles, it isn’t always easy to read branch lengths on them. Circular layouts place the root at the center, and the tips around the edges. This is a very compact representation that works well for very large trees. Figure 2.6: The same tree as above, layed out in several different ways. 2.3 Rotating nodes One of the most important things to keep in mind when interpreting a phylogeny is that the order of the tips doesn’t have any information content. You can rotate any internal node, changing the order of the tips, and you still have the exact same phylogeny, just drawn a different way (Figure 2.7). The topology remains unchanged. It’s the connections that tell us about the relationships. JD Laurence-Chasen, a former student in my invertebrate zoology course, made an excellent video about this – https://vimeo.com/148794860 . Figure 2.7: The exact same phylogeny, drawn a few times with different node rotations. 2.4 The meaning of edge lengths Another source of variation to keep in mind is the meaning of edge length (Figure 2.8). A phylogeny where edge lengths are scaled to time is known as a chronogram. In many cases we don’t have the information needed to scale edges to time, which requires fossil calibrations. Chronograms of organisms all sampled at the same time will be ultrametric, ie the tip nodes will be flush. If they are sampled at different times, for example when including fossils or sampling a rapidly evolving virus at different time points, they will not be ultrametric. Most published trees therefore scale the edges according to the expected amount of evolutionary change in the characters under consideration. The rate of evolution usually varies a bit across edges, so phylograms are not usually ultrametric. Sometimes we are only interested in, or only have information about, the topology of the phylogeny. In this case we can draw the edges with uniform length, and we call the phylogeny a cladogram. Cladograms can also be useful for showing annotations on edges in phylogenies with a wide variation in edge lengths, since there might not be enough room to write labels on very short edges. It is always good practice whenever you show a phylogeny to indicated whether it is a chronogram, phylogram, or cladogram. This is inconsistent int he literature, though, and if you aren’t sure it is best to just ignore edge lengths at treat the tree as if it were a cladogram. Figure 2.8: Several types of trees. In a chronogram, edge lengths are scaled according to time. In a phylogram, edge lengths are scaled according to expected amount of evolutionary change, which can differ across characters and edges. In a cladogram, the edge lengths have no meaning. 2.5 Rooting The root of a phylogeny is the node that has no parent. This seems simple enough, but the concept is actually quite complicated once you get into the details. There are a few different contexts to consider rooting in– the actual phylogeny, the phylogeny as it is stored in computer memory, and the phylogeny as it is drawn. In a chronogram, where edges lengths indicate time and time proceeds in a particular direction along the edges, all three rooting concepts are consistent. The root is just the oldest node, and therefore the node furthest from the tips (Figure 2.9). Where things get confusing is when we don’t know where the root is. This is often something we are trying to figure out, and takes external information (such as knowing that some of the nodes form an outgroup). It may be that we know the topology of the phylogeny (ie, how the nodes are connected with edges), but we just don’t know where the root is. It could be any of the internal nodes, or it could actually be along any of the edges connecting the nodes. Where things get really, really confusing is that trees are often drawn in a rooted format even when we don’t know where the root is. So just because a phylogeny is drawn like that in (Figure 2.9), don’t assume that the author knows where the root actually is unless they say so. Figure 2.9: The root of the mammal tree is shown in red. 2.6 Polytomies Polytomies are internal nodes with more than two child nodes (or, in the case of unrooted trees, internal nodes that have more than three edges). star / comb phylogeny 2.7 The information contained in phylogenies Thinking about phylogenies as graphs gives us very explicit ways to think about what information can be contained in a phylogeny. In the fundamental graphical sense, a phylogeny is a pair of sets – a set of nodes and a set of edges – and annotations on those entities. The topology of the phylogeny is the way in which nodes are connected by edges. If there are different connections in two trees, then they have different topologies. If the annotations differ but the connections are the same, then the topolpgies are the same. Sometimes we know more and sometimes less about the topology. A fully resolved bifurcating phylogeny, where every internal node has two children, contains maximal information about the topology. A completely unresolved star phylogeny contains no information about topology. Node annotations can include: Labels. These could be species names, gene names, museum accession numbers for particular specimens, or broader clade names (eg Mammalia). Character states. The presence or absence of particular attributes (like hair), or the particular nucleotide at a particular spot in a particular gene (CGTA). Geographical locations. Edge annotations can include: Length. The value and unit of length can differ, for example it can time (as in a chronogram) or expected amount of change in a particular set of characters (as in a phylogram). Directionality. An indication of which direction time goes in along each branch. This only applies in the context of a rooted tree. Events. These could include a character change (such as the gain of a placenta) or a geographical change (such as an intercontinental dispersal event). Nodes need not be different in the relevant trait to have change events. For example, at a particular gene site a parent and a child node could both have an A. There could be two or more events along the edge that are compatible with this pattern, for example a change from A to C and then a change from C back to A. Edge frequencies.This is how topology support values such as bootstraps and posterior probabilities, which we’ll discuss later, are stored. Not all trees have all this information. The minimum possible information a tree could contain is just the number of tips. With this, you could could draw an unresolved, unlabeled cladogram (Figure 2.10A). You could then start layering information onto that tree. For example, you could next add images denoting the species at the tips (Figure 2.10B). That tells you what species are in the phylogeny, but nothing about how they are related. Next you could add internal nodes and edges that indicate the topology of the tree (Figure 2.10C). Once you have topology, you could display edge attributes. For example, you could scale the edge lengths by time (Figure 2.10D). At each step in this process of layering on information, the phylogeny is compatible with a very large set of possible phylogenies. At one extreme, Figure 2.10A is compatible with any phylogeny with any branch lengths for any 11 species or organisms or genes. Each added piece of information narrows that subset. When we label the tips as in Figure 2.10B, it is compatible with any phylogeny with any branch lengths for those specific species. And so on. More information provides more specificity. We could go well beyond Figure 2.10D, for example by labeling internal nodes or showing character states. The amount of information in a phylogeny varies greatly depending on a variety of factors, including what information is available, what the question at hand is, and what makes the most sense for the focused description of the biology at hand. One investigator may go to great lengths to calibrate branch lengths, for example, while another couldn’t care less about branch lengths and is only interested in topology. Figure 2.10: Adding information to a phylogeny makes it more specific. 2.8 Representation So far we have focused on phylogenies in the abstract sense as mathematical graphs and their associated annotations, and in the concrete sense as paranthetical ape ggtree 2.9 Final thoughts 2.10 Additional reading The ggtree book - https://yulab-smu.github.io/treedata-book/index.html ggtree vignettes - https://bioconductor.statistik.tu-dortmund.de/packages/3.1/bioc/vignettes/ggtree/inst/doc/ggtree.html References "],
["simulation.html", "Chapter 3 Simulation 3.1 Models 3.2 A simple model 3.3 Generalizing the simple model 3.4 More complex models 3.5 Model structure 3.6 Aditional resources", " Chapter 3 Simulation Build the machinery to simulate the evolution of traits on trees. Focus for now on DNA evolution. 3.1 Models Generative models The intent is a simplified representation of the process under consideration. “All models are wrong, some are useful” 3.2 A simple model Let’s start with a simple model of DNA evolution. At first we will also consider only a single nucleotide position. Imagine that when the DNA is being replicated, most of the time the appropriate nucleotide is incorporated. Some fraction of the time, at rate \\(\\mu\\), an event occurs where the appropriate nucleotides is replaced with a random nucleotide instead. The probability of selecting any of the nucleotides during one of these random replacement events is uniform (picking a C is just as probably as picking a G, for example), and the new nucleotide doesn’t depend in any way on what nucleotide was there before. It is as if you had a bag containing equal frequencies of C, G, T, and A nucleotides. As you built the new DNA strand, every so often you would replace the nucleotide you should be adding with one you instead selected by reaching into the bag with your eyes closed and picking one at random. Not all replacement events will result in an apparent change. Sometimes the appropriate nucleotide is selected by chance, even though it was picked at random. If, for example, the appropriate nucleotide was an A, under this model \\(1/4\\) of the time a replacement event occurs an A is selected by chance and there is no apparent change. In such a case, there has not been a substitution (just a replacement in kind). If the A is replaced with any of the other three nucleotides we say there has been a substitution. Because three of the four possible outcomes of an event result in a substitution, the substitution rate is \\(3\\beta\\), which, because \\(\\beta=\\mu/4\\), is equivalent to noting that the substitution is \\((3/4) \\mu\\). Because some events result in no apparent change, substitutions are only a subset of events and the substitution rate is lower than the replacement event rate. It might seem a bit odd to consider replacement events that don’t result in substitutions, but this follows naturally from a central feature we specified for the the model - the new nucleotide doesn’t depend in any way on what nucleotide was there before. If we had a process where replacements always resulted in substitutions, then excluding the a replacement in kind would require knowing which nucleotide should be placed so that we don’t select it. 3.2.1 Expected amount of change One of the primary values of a model is that it allows us to think explicitly about how much evolutionary change we expect to see under the specified process. For the simple process described here, there are two things to consider if we want to know the amount of evolutionary change. The first is the substitution rate \\(\\mu\\) (which we also know if we know \\(\\beta\\), since \\(\\mu=4\\beta\\)), and the time over which the evolutionary process acts. In Figure 3.1 the amount of evolutionary time is held constant, and the rate \\(\\mu\\) is changed. When \\(\\mu=0\\), the bottom bar, there are no replacements (black bars) and therefore no substitutions (the whole bar is the same color). Figure 3.1: Each horizontal bar is a simulation of evolution of a single nucleotide position through time, \\(t\\), for a specified value of \\(\\mu\\). Each sumulation starts out as an A. Black vertical bars correspond to replacement events, which don’t all lead to substitutions (a new color). As \\(\\mu=0\\) increases (going up on the \\(y\\) axis), the number of replacement events over the same time interval increases (Figure 3.2). This reflects the simple linear relationship \\(n=\\mu t\\), where \\(n\\) is the number of expected replacement events. Figure 3.2: The number of replacement events increases linearly with the replacement rate \\(\\mu\\). This plot is from the same simulation as that shown in Figure 3.1. The line is a linear model fit to the data. Because of the linear relationship between the number of replacements and the product \\(\\mu t\\), rate and time are conflated. In many scenarios you can’t estimate them independently. If there are a small number of replacements, for example, you can’t be sure if there is a low rate over a long time interval or a high rate over a short interval. Both would give the same result. Because they are so often confounded in phylogenetic questions, often the rate is essentially fixed at one and the unit of time for edge lengths is given as the number of expected evolutionary change rather than absolute time (years, months, etc). You will often see this length as the scale bar of published phylogenies (Figure 3.3). The exception is when you have external information, such as dated fossils, that allow you to independently estimate edge lengths and rates. Figure 3.3: A published phylogeny (Zapata et al. 2015) with a scale bar indicating branch length in terms of the expected amount of evolutionary change, rather than absolute time. 3.2.2 Expected end state The machinery above shows how a model can clarify the way we think about the expected amount of change. Many times, though, we want to know what the probability of a given end state is given a starting state, a model, and the amount of time elapsed. One way to anchor such a question is to think about the extremes - what do we expect after a very small amount of change (either a short time or a slow rate of change, or both), and what do we expect after a large amount of change? The situation is most clear after a small amount of change - we expect the end result to be the same as the starting condition. If we start with an A, for example, we expect to end with an A (Figure 3.4, left side). In this situation, if we know the starting state that information tells us a lot about the end state. Not much else matters. What should we expect, though, if there has been a large amount of change? Can we know anything at all? It turns out that we can. If there have been many replacements, one after the other, than the initial starting state really doesn’t matter at all because whatever was there will probably have been replaced multiple times. If the starting state doesn’t contain information about the end state, what does? It is the bag that you are picking the nucleotides at random from. Given enough evolutionary time, our simple model will lead the expected frequency of each nucleotide in the evolving sequence to be the same as the frequency in the bag that we randomly draw them from. Since we specified that you have the same chance of grabbing any nucleotide from the bag, eventually the probability of having each of the our nucleotides is the same, 25% (Figure 3.4, right side). If you started with a sequence that had an A and let it evolve 100 times, after enough evolutionary time had passed to reach equilibrium you would expect to get 25 C’s, 25 G’s, 25 T’s, and 25 A’s. Figure 3.4: Stacked bar plots indicating the frequency of each nucleotide after evolution for a specified amount of time. The rate of evolution is $= 0.05 $. There are 1000 replicate simulations for each value of time. At time=0 (no evolution), the end result is always the same as the initial value, which is fixed at A in these simulations. As the length of time increases, the four nucleotides converge on equal frequencies of 25% each. 3.3 Generalizing the simple model rates, equilibrium frequencies ## [,1] ## [1,] 0 ## [2,] 0 ## [3,] 0 ## [4,] 0 exponentiation 3.4 More complex models 3.5 Model structure 3.6 Aditional resources My own thinking about this material was heavilly influenced by Paul Lewis’s wonderful lectures at the annual Workshop on Molecular Evolution at Woods Hole. Some of his lectures are now available online as part of the excellent Phylo Seminar, starting with https://www.youtube.com/watch?v=1r4z0YJq580&amp;t=2111s A great introduction to continuous time models by John Huelsenbeck https://revbayes.github.io/tutorials/dice/ References "],
["inference.html", "Chapter 4 Inference", " Chapter 4 Inference A specific task - given a set of character data corresponding to the tips of a tree, what is the topology of the tree? Model is also estimated, but may or may not be of interest. Calculating the likelihood of a tree What a likelihood is maximum likelihood hueristics Bayesian “Model free” methods "],
["evaluation.html", "Chapter 5 Evaluation 5.1 Model evaluation 5.2 Topology evaluation 5.3 Sensitiviy 5.4 Confidence 5.5 Epistemology", " Chapter 5 Evaluation 5.1 Model evaluation Why not add as many parameters as you can imagine? Likelihood ratio test AIC BIC 5.2 Topology evaluation 5.3 Sensitiviy changing methods and parameters adding noise 5.4 Confidence Propogation, point estimates 5.5 Epistemology gene trees, species trees "],
["future.html", "Chapter 6 Future", " Chapter 6 Future Integrated models of genome evolution "],
["shape.html", "Chapter 7 Shape", " Chapter 7 Shape Dating Diversification Extinction, birth, death Null models "],
["character-evolution.html", "Chapter 8 Character evolution", " Chapter 8 Character evolution Comparative biology Reconstructing a single trait on trees Trait correlation Models of character change, including rate "],
["applications.html", "Chapter 9 Applications 9.1 Functional genomic data 9.2 Gene trees", " Chapter 9 Applications 9.1 Functional genomic data 9.2 Gene trees "],
["references.html", "References", " References "]
]
